# -*- coding: utf-8 -*-
"""
Created on Mon Oct  8 21:31:35 2018

@author: Camargos C / Luis Barresi
"""

import os

class OutputFileManipulator(object):
    # calls everthing else (open inputfile command in subclass)
    def __init__(self, outList, areasList,core_nr):
        self.textOld = self.inputFile.readlines()
        self.inputFile.close()
        self.outValues = self.readValues(outList,areasList,core_nr)
        self.write(core_nr)
        self.core_nr = core_nr
               
    def readValues(self, outList, areasList,core_nr):     
        outValues = {}
        for outName in outList:
            outValues[outName] = {}
            for area in areasList:
                outValues[outName][area] = []
                #outValues[outName][areasList] = []
        row = self.outInfo["firstRow"]-1
        for textRow in self.textOld[row:]:
            col1, col2 = self.outInfo["gis_id"]
            area = int(textRow[col1:col2])
            if area in areasList:
                for outName in outValues:
                    col1, col2 = self.outInfo[outName]
                    outValues[outName][area].append(float(textRow[col1:col2]))
        return outValues
        
    def write(self, core_nr):
        for outName in self.outValues:
            for area in self.outValues[outName]:
                outText = []
                for value in self.outValues[outName][area]:
                    outText.append("%.3E"%value + " ")
                outText[len(outText)-1] = outText[len(outText)-1].replace(" ", "\n")
        return outText

class basin_sd_chamorph_day(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               #"aqu_in_m3s":     ( 75, 89),
               "geo_bf_in_m3s": ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_chamorph_day.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_chamorph_mon(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               #"aqu_in_m3s":     ( 75, 89),
               "geo_bf_in_m3s": ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_chamorph_mon.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_chamorph_yr(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               #"aqu_in_m3s":     ( 75, 89),
               "geo_bf_in_m3s": ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_chamorph_yr.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_chamorph_aa(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               #"aqu_in_m3s":     ( 75, 89),
               "geo_bf_in_m3s": ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}
    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_chamorph_aa.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_cha_day(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                 "jday":         (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}              
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_cha_day.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_cha_mon(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                 "jday":         (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}              
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_cha_mon.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)
               
class basin_sd_cha_yr(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                 "jday":         (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}              
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_cha_yr.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class basin_sd_cha_aa(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                 "jday":         (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}              
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"basin_sd_cha_aa.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)        
               
class channel_sd_day(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
               "jday":           (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 32),
               "gis_id":         ( 33, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sd_day.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList,  core_nr)

class channel_sd_mon(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
               "jday":           (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 32),
               "gis_id":         ( 33, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sd_mon.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList,  core_nr)

class channel_sd_yr(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
               "jday":           (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 32),
               "gis_id":         ( 33, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sd_yr.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList,  core_nr)

class channel_sd_aa(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
               "jday":           (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 32),
               "gis_id":         ( 33, 40),
               "name":           ( 41, 59),
               "area":           ( 60, 73),
               "precip":         ( 74, 88),
               "evap":           ( 89,103),
               "seep":           (104,118),
               "flo_stor":       (119,133),
               "sed_stor":       (134,148),
               "orgn_stor":      (149,163),
               "sedp_stor":      (164,178),
               "no3_stor":       (179,193),
               "solp_stor":      (194,208),
               "chla_stor":      (209,223),
               "nh3_stor":       (224,238),
               "no2_stor":       (239,253),
               "cbod_stor":      (254,268),
               "dox_stor":       (269,283),
               "san_stor":       (284,298),
               "sil_stor":       (299,313),
               "cla_stor":       (314,328),
               "sag_stor":       (329,343),
               "lag_stor":       (344,358),
               "grv_stor":       (359,373),
               "temp_stor":      (374,388),
               "flo_in":         (389,403),
               "sed_in":         (404,418),
               "orgn_in":        (419,433),
               "sedp_in":        (434,448),
               "no3_in":         (449,463),
               "solp_in":        (464,478),
               "chla_in":        (479,493),
               "nh3_in":         (494,508),
               "no2_in":         (509,523),
               "cbod_in":        (524,538),
               "dox_in":         (539,553),
               "san_in":         (554,568),
               "sil_in":         (569,583),
               "cla_in":         (584,598),
               "sag_in":         (599,613),
               "lag_in":         (614,628),
               "grv_in":         (629,643),
               "temp_in":        (644,658),
               "flo_out":        (659,673),
               "sed_out":        (674,688),
               "orgn_out":       (689,703),
               "sedp_out":       (704,718),
               "no3_out":        (719,733),
               "solp_out":       (734,748),
               "chla_out":       (749,763),
               "nh3_out":        (764,778),
               "no2_out":        (779,793),
               "cbod_out":       (794,808),
               "dox_out":        (809,823),
               "san_out":        (824,838),
               "sil_out":        (839,853),
               "cla_out":        (854,868),
               "sag_out":        (869,883),
               "lag_out":        (889,898),
               "grv_out":        (904,913),
               "temp_out":       (919,928)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sd_aa.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList,  core_nr)

class channel_sdmorph_day(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               "aqu_in_m3s":     ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sdmorph_day.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class channel_sdmorph_mon(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               "aqu_in_m3s":     ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sdmorph_mon.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class channel_sdmorph_yr(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               "aqu_in_m3s":     ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sdmorph_yr.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)

class channel_sdmorph_aa(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (4),
                "jday":          (  1,  6),
               "mon":            (  7, 12),
               "day":            ( 13, 18),
               "yr":             ( 19, 24),
               "unit":           ( 25, 34),
               "gis_id":         ( 35, 40),
               "name":           ( 41, 59),
               "flo_in_m3s":     ( 60, 74),
               "aqu_in_m3s":     ( 75, 89),
               "flo_out_m3s":    ( 90,104),
               "peakr":          (105,119),
               "sed_in":         (120,134),
               "sed_out":        (135,149),
               "washld":         (150,164),
               "bedld":          (165,179),
               "dep":            (180,194),
               "deg_btm":        (195,209),
               "deg_bank":       (210,224),
               "hc_sed":         (225,239),
               "width":          (240,254),
               "depth":          (255,269),
               "slope":          (270,284),
               "deg_btm_m":      (285,299),
               "deg_bank_m":     (300,314),
               "hc_len":         (315,329),
               "flo_in_mm":      (330,344),
               "aqu_in_mm":      (345,359),
               "flo_out_mm":     (360,374)}    
    def __init__(self, outList, areasList, core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_sdmorph_aa.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)
        
class chaYearOutputManipulator(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (3),
               "jday":           (  1,  6),
               "mon":            (  7, 13),
               "day":            ( 14, 19),
               "yr":             ( 20, 24),
               "unit":           ( 25, 32),
               "gis_id":         ( 33, 40),
               "name":           ( 41, 47),
               "floin_ha-m":     ( 48, 73),
               "floout_ha-m":    ( 74, 88),
               "evap_ha":        ( 89,103),
               "tloss_ha-m":     (104,118),
               "sedin_ton":      (109,133),
               "sedout_ton":     (134,148),
               "sedconc_mg/":    (149,163),
               "orgnin_kg":      (164,178),
               "orgnout_kgN":    (179,193),
               "orgpin_kg":      (194,208),
               "orgpout_k":      (209,223),
               "no3in_kg":       (224,238),
               "no3out_kg":      (239,253),
               "nh4in_k":        (254,268),
               "nh4out_k":       (269,283),
               "no2in_k":        (284,298),
               "no2out_k":       (299,313),
               "solpin_kg":      (314,328),
               "solpout_kg":     (329,343),
               "chlain_k":       (344,358),
               "chlaout_k":      (359,373),
               "cbodin_k":       (374,388),
               "cbodout_k":      (389,403),
               "disin_k":        (404,418),
               "disout_k":       (419,433),
               "solpsti_mgps":   (434,448),
               "solpsto_mgps":   (449,463),
               "sorbpsti_mgps":  (464,478),
               "sorbpsto_mgps":  (479,493),
               "react_mgps":     (494,508),
               "volat_m":        (509,523),
               "setlpst_mgps":   (524,538),
               "resuspst_m":     (539,553),
               "difus_mgps":     (554,568),
               "reactb_sedm":    (569,583),
               "bury_burym":     (584,598),
               "sedpest_m":      (599,613),
               "bac":            (614,628),
               "bacl":           (629,643),
               "met":            (644,658),
               "met1":            (659,673),
               "met2":            (674,688),
               "sand_i":         (689,703),
               "sand_ou":        (704,718),
               "silt_i":         (719,733),
               "silt_ou":        (734,748),
               "clay_i":         (749,763),
               "clay_ou":        (764,778),
               "smag_i":         (779,793),
               "smag_ou":        (794,808),
               "lag_i":          (809,823),
               "lag_ou":         (824,838),
               "grvl_i":         (839,853),
               "grvl_ou":        (854,868),
               "bnk_er":         (869,883),
               "ch_de":          (884,888),
               "ch_de1":          (889,913),
               "fp_de":          (914,928),
               "tot_sse":        (929,943)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"channel_yr.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList,  core_nr)    
        
class hydinDayOutputManipulator(OutputFileManipulator):
    outInfo = {"type":         ".txt",
               "firstRow":       (3),
               "jday":           (  1, 12),
               "mon":            ( 13, 24),
               "day":            ( 25, 36),
               "yr":             ( 37, 48),
               "unit":           ( 49, 60),
               "gis_id":         ( 61, 72),
               "name":           ( 73, 79),
               #"type":          ( 80, 92),
               "objtyp":        ( 93,101),
               "typ_no":        (102,117),
               "hyd_typ":       (118,121),
               "fraction":      (122,132),
               "flo_m^3":       (133,151),
               "sed_mtons":     (152,166),
               "orgn_kgN":      (167,181),
               "sedp_kgP":      (182,196),
               "no3_kgN":       (197,211),
               "solp_kgP":      (212,226),
               "psol_mgpst":    (227,241),
               "psor_mgpst":    (242,256),
               "chla_kg":       (257,271),
               "nh3_kgN":       (272,286),
               "no2_kgN":       (287,301),
               "cbod_kg":       (302,316),
               "dox_kg":        (317,331),
               "bacp_#cfu/100ml":   (332,346),
               "baclp_#cfu/100m":   (347,361),
               "met1_kg":       (362,376),
               "met2_kg":       (377,391),
               "met3_kg":       (392,406),
               "san_tons":      (407,421),
               "sil_tons":      (422,436),
               "cla_tons":      (437,451),
               "sag_tons":      (452,466),
               "lag_tons":      (467,481),
               "grv_tons":      (482,496),
               "temp_degc":     (497,511)}    
    def __init__(self, outList, areasList,  core_nr):
        self.inputFile = open('calib_parallel'+os.sep+'parallel_'+core_nr+os.sep+"hydin.txt", "r")
        OutputFileManipulator.__init__(self, outList, areasList, core_nr)
        
    def readAreaSizes(self, areasList):
        areaSizes = {}
        for area in areasList:
            areaSizes[area] = None
        row = self.outInfo["firstRow"]-1
        for textRow in self.textOld[row:]:
            col1, col2 = self.outInfo["gis_id"]
            area = int(textRow[col1:col2])
        return areaSizes
        
    def readValues(self, outList, areasList):
        outValues = {}
        for outName in outList:
            outValues[outName] = {}
            for area in areasList:
                outValues[outName][area] = []
        row = self.outInfo["firstRow"]-1
        for textRow in self.textOld[row:]:
            col1, col2 = self.outInfo["gis_id"]
            area = int(textRow[col1:col2])
            if area in areasList:
                for outName in outValues:
                    col1, col2 = self.outInfo[outName]
                    outValues[outName][area].append(float(textRow[col1:col2]))
        return outValues